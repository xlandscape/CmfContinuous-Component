{"code": "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar p = require(\"core/properties\");\nvar dom_1 = require(\"core/dom\");\nvar widget_1 = require(\"models/widgets/widget\");\nvar PlayerView = /** @class */ (function (_super) {\n    __extends(PlayerView, _super);\n    function PlayerView() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    PlayerView.prototype.initialize = function (options) {\n        _super.prototype.initialize.call(this, options);\n        this.render();\n    };\n    PlayerView.prototype.connect_signals = function () {\n        var _this = this;\n        _super.prototype.connect_signals.call(this);\n        this.connect(this.model.change, function () { return _this.render(); });\n        this.connect(this.model.properties.value.change, function () { return _this.render(); });\n        this.connect(this.model.properties.loop_policy.change, function () { return _this.set_loop_state(_this.model.loop_policy); });\n    };\n    PlayerView.prototype.get_height = function () {\n        return 250;\n    };\n    PlayerView.prototype.render = function () {\n        var _this = this;\n        if (this.sliderEl == null) {\n            _super.prototype.render.call(this);\n        }\n        else {\n            this.sliderEl.style = \"width:{this.model.width}px\";\n            this.sliderEl.min = this.model.start;\n            this.sliderEl.max = this.model.end;\n            this.sliderEl.value = this.model.value;\n            return;\n        }\n        // Slider\n        this.sliderEl = document.createElement('input');\n        this.sliderEl.setAttribute(\"type\", \"range\");\n        this.sliderEl.style = \"width:{this.model.width}px\";\n        this.sliderEl.value = this.model.value;\n        this.sliderEl.min = this.model.start;\n        this.sliderEl.max = this.model.end;\n        this.sliderEl.onchange = function (ev) { return _this.set_frame(parseInt(ev.target.value)); };\n        // Buttons\n        var button_div = dom_1.div();\n        button_div.style = \"margin: 0 auto; display: table; padding: 5px\";\n        var button_style = \"text-align: center; min-width: 40px\";\n        var slower = document.createElement('button');\n        slower.style = \"text-align: center; min-width: 20px\";\n        slower.appendChild(document.createTextNode('\u2013'));\n        slower.onclick = function () { return _this.slower(); };\n        button_div.appendChild(slower);\n        var first = document.createElement('button');\n        first.style = button_style;\n        first.appendChild(document.createTextNode('\\u275a\\u25c0\\u25c0'));\n        first.onclick = function () { return _this.first_frame(); };\n        button_div.appendChild(first);\n        var previous = document.createElement('button');\n        previous.style = button_style;\n        previous.appendChild(document.createTextNode('\\u275a\\u25c0'));\n        previous.onclick = function () { return _this.previous_frame(); };\n        button_div.appendChild(previous);\n        var reverse = document.createElement('button');\n        reverse.style = button_style;\n        reverse.appendChild(document.createTextNode('\\u25c0'));\n        reverse.onclick = function () { return _this.reverse_animation(); };\n        button_div.appendChild(reverse);\n        var pause = document.createElement('button');\n        pause.style = button_style;\n        pause.appendChild(document.createTextNode('\\u275a\\u275a'));\n        pause.onclick = function () { return _this.pause_animation(); };\n        button_div.appendChild(pause);\n        var play = document.createElement('button');\n        play.style = button_style;\n        play.appendChild(document.createTextNode('\\u25b6'));\n        play.onclick = function () { return _this.play_animation(); };\n        button_div.appendChild(play);\n        var next = document.createElement('button');\n        next.style = button_style;\n        next.appendChild(document.createTextNode('\\u25b6\\u275a'));\n        next.onclick = function () { return _this.next_frame(); };\n        button_div.appendChild(next);\n        var last = document.createElement('button');\n        last.style = button_style;\n        last.appendChild(document.createTextNode('\\u25b6\\u25b6\\u275a'));\n        last.onclick = function () { return _this.last_frame(); };\n        button_div.appendChild(last);\n        var faster = document.createElement('button');\n        faster.style = \"text-align: center; min-width: 20px\";\n        faster.appendChild(document.createTextNode('+'));\n        faster.onclick = function () { return _this.faster(); };\n        button_div.appendChild(faster);\n        // Loop control\n        this.loop_state = document.createElement('form');\n        this.loop_state.style = \"margin: 0 auto; display: table\";\n        var once = document.createElement('input');\n        once.type = \"radio\";\n        once.value = \"once\";\n        once.name = \"state\";\n        var once_label = document.createElement('label');\n        once_label.innerHTML = \"Once\";\n        once_label.style = \"padding: 0 10px 0 5px; user-select:none;\";\n        var loop = document.createElement('input');\n        loop.setAttribute(\"type\", \"radio\");\n        loop.setAttribute(\"value\", \"loop\");\n        loop.setAttribute(\"name\", \"state\");\n        var loop_label = document.createElement('label');\n        loop_label.innerHTML = \"Loop\";\n        loop_label.style = \"padding: 0 10px 0 5px; user-select:none;\";\n        var reflect = document.createElement('input');\n        reflect.setAttribute(\"type\", \"radio\");\n        reflect.setAttribute(\"value\", \"reflect\");\n        reflect.setAttribute(\"name\", \"state\");\n        var reflect_label = document.createElement('label');\n        reflect_label.innerHTML = \"Reflect\";\n        reflect_label.style = \"padding: 0 10px 0 5px; user-select:none;\";\n        if (this.model.loop_policy == \"once\")\n            once.checked = true;\n        else if (this.model.loop_policy == \"loop\")\n            loop.checked = true;\n        else\n            reflect.checked = true;\n        // Compose everything\n        this.loop_state.appendChild(once);\n        this.loop_state.appendChild(once_label);\n        this.loop_state.appendChild(loop);\n        this.loop_state.appendChild(loop_label);\n        this.loop_state.appendChild(reflect);\n        this.loop_state.appendChild(reflect_label);\n        this.el.appendChild(this.sliderEl);\n        this.el.appendChild(button_div);\n        this.el.appendChild(this.loop_state);\n    };\n    PlayerView.prototype.set_frame = function (frame) {\n        if (this.model.value != frame)\n            this.model.value = frame;\n        if (this.sliderEl.value != frame)\n            this.sliderEl.value = frame;\n    };\n    PlayerView.prototype.get_loop_state = function () {\n        var button_group = this.loop_state.state;\n        for (var i = 0; i < button_group.length; i++) {\n            var button = button_group[i];\n            if (button.checked)\n                return button.value;\n        }\n    };\n    PlayerView.prototype.set_loop_state = function (state) {\n        var button_group = this.loop_state.state;\n        for (var i = 0; i < button_group.length; i++) {\n            var button = button_group[i];\n            if (button.value == state)\n                button.checked = true;\n        }\n    };\n    PlayerView.prototype.next_frame = function () {\n        this.set_frame(Math.min(this.model.end, this.model.value + this.model.step));\n    };\n    PlayerView.prototype.previous_frame = function () {\n        this.set_frame(Math.max(this.model.start, this.model.value - this.model.step));\n    };\n    PlayerView.prototype.first_frame = function () {\n        this.set_frame(this.model.start);\n    };\n    PlayerView.prototype.last_frame = function () {\n        this.set_frame(this.model.end);\n    };\n    PlayerView.prototype.slower = function () {\n        this.model.interval = Math.round(this.model.interval / 0.7);\n        if (this.model.direction > 0)\n            this.play_animation();\n        else if (this.direction < 0)\n            this.reverse_animation();\n    };\n    PlayerView.prototype.faster = function () {\n        this.model.interval = Math.round(this.model.interval * 0.7);\n        if (this.model.direction > 0)\n            this.play_animation();\n        else if (this.model.direction < 0)\n            this.reverse_animation();\n    };\n    PlayerView.prototype.anim_step_forward = function () {\n        if (this.model.value < this.model.end) {\n            this.next_frame();\n        }\n        else {\n            var loop_state = this.get_loop_state();\n            if (loop_state == \"loop\") {\n                this.first_frame();\n            }\n            else if (loop_state == \"reflect\") {\n                this.last_frame();\n                this.reverse_animation();\n            }\n            else {\n                this.pause_animation();\n                this.last_frame();\n            }\n        }\n    };\n    PlayerView.prototype.anim_step_reverse = function () {\n        if (this.model.value > this.model.start) {\n            this.previous_frame();\n        }\n        else {\n            var loop_state = this.get_loop_state();\n            if (loop_state == \"loop\") {\n                this.last_frame();\n            }\n            else if (loop_state == \"reflect\") {\n                this.first_frame();\n                this.play_animation();\n            }\n            else {\n                this.pause_animation();\n                this.first_frame();\n            }\n        }\n    };\n    PlayerView.prototype.pause_animation = function () {\n        this.direction = 0;\n        if (this.timer) {\n            clearInterval(this.timer);\n            this.timer = null;\n        }\n    };\n    PlayerView.prototype.play_animation = function () {\n        var _this = this;\n        this.pause_animation();\n        this.model.direction = 1;\n        if (!this.timer)\n            this.timer = setInterval(function () { return _this.anim_step_forward(); }, this.model.interval);\n    };\n    PlayerView.prototype.reverse_animation = function () {\n        var _this = this;\n        this.pause_animation();\n        this.model.direction = -1;\n        if (!this.timer)\n            this.timer = setInterval(function () { return _this.anim_step_reverse(); }, this.model.interval);\n    };\n    return PlayerView;\n}(widget_1.WidgetView));\nexports.PlayerView = PlayerView;\nvar Player = /** @class */ (function (_super) {\n    __extends(Player, _super);\n    function Player(attrs) {\n        return _super.call(this, attrs) || this;\n    }\n    Player.initClass = function () {\n        this.prototype.type = \"Player\";\n        this.prototype.default_view = PlayerView;\n        this.define({\n            direction: [p.Number, 0],\n            interval: [p.Number, 500],\n            start: [p.Number,],\n            end: [p.Number,],\n            step: [p.Number, 1],\n            loop_policy: [p.Any, \"once\"],\n            value: [p.Any, 0],\n        });\n        this.override({ width: 350 });\n    };\n    return Player;\n}(widget_1.Widget));\nexports.Player = Player;\nPlayer.initClass();\n", "deps": ["core/properties", "core/dom", "models/widgets/widget"], "hash": "e8622e79aaaea713487474f6d47108edade960349000fb46eee7f9e9f157e73c"}